{% extends "base.html" %}

{% block content %}

<style>
/* Add custom CSS here */
.view-lead-link:hover, .assign-agent-link:hover {
    color: #00008B; /* Dark blue color for hover state */
}
</style>

<section class="text-gray-600 body-font">
     <div class="container px-5 py-24 mx-auto flex flex-wrap">
          <div class="w-full mb-6 py-6 flex justify-between items-center border-b border-gray-200">
               <div>
                    <h1 class="text-4xl text-gray-800">Leads</h1>
                    <a class="text-gray-500 hover:text-blue-500" href="{% url 'leads:category-list' %}">View categories</a>
               </div>
               {% if request.user.is_organisor %}
               <div>
                    <a class="text-gray-500 hover:text-blue-500" href="{% url 'leads:lead-create' %}">Create a new lead</a>
               </div>
               {% endif %}
          </div>
          <div class="flex flex-wrap -m-4">
               {% for lead in leads %}
               <div class="p-4 w-full">
                    <div class="flex border-2 rounded-lg border-gray-600 p-8 sm:flex-row flex-col">
                         <div class="w-16 h-16 sm:mr-8 sm:mb-0 mb-4 rounded-full overflow-hidden flex-shrink-0 bg-indigo-100 flex items-center justify-center">
                              {% if lead.profile_image %}
                              <img src="{{ lead.profile_image.url }}" alt="{{ lead.first_name }} {{ lead.last_name }}" class="w-full h-full object-cover">
                              {% else %}
                              <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-8 h-8 text-indigo-500" viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
                              {% endif %}
                         </div>
                         <div class="flex-grow">
                              <h2 class="text-gray-900 text-lg title-font font-medium mb-3">{{ lead.first_name }} {{ lead.last_name }}</h2>
                              <div class="leading-relaxed text-base mb-3">
                                   <p class="mb-1"><strong>Email:</strong> {{ lead.email|default:"Not provided" }}</p>
                                   <p class="mb-1"><strong>Phone:</strong> {{ lead.phone_number|default:"Not provided" }}</p>
                                   <p class="mb-1"><strong>Source:</strong> <span class="text-blue-600 font-medium">{{ lead.source_category.name|default:"Unassigned" }}</span></p>
                                   <p class="mb-1"><strong>Value:</strong> <span class="text-green-600 font-medium">{{ lead.value_category.name|default:"Unassigned" }}</span></p>
                                   {% if lead.agent %}
                                   <p class="mb-1"><strong>Agent:</strong> <span class="text-purple-600 font-medium">{{ lead.agent.user.username }}</span></p>
                                   {% endif %}
                                   {% if request.user.is_superuser %}
                                   <p class="mb-1"><strong>Organisation:</strong> <span class="text-orange-600 font-medium">{{ lead.organisation.user.username }}</span></p>
                                   {% endif %}
                              </div>
                              <a href="{% url 'leads:lead-detail' lead.pk %}" class="view-lead-link mt-3 text-indigo-500 inline-flex items-center hover:text-blue-900">View this lead
                                   <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 ml-2" viewBox="0 0 24 24">
                                        <path d="M5 12h14M12 5l7 7-7 7"></path>
                                   </svg>
                              </a>
                         </div>
                    </div>
               </div>
               {% endfor %}
          </div>
          <!-- Unassigned Leads Section -->
          {% if unassigned_leads.exists %}
          <div class="w-full mt-12 mb-6">
               <h1 class="text-4xl text-gray-800 mb-6">Unassigned Leads</h1>
          </div>
          <div class="flex flex-wrap -m-4">
               {% for lead in unassigned_leads %}
               <div class="p-4 w-full">
                    <div class="flex border-2 rounded-lg border-gray-600 p-8 sm:flex-row flex-col">
                         <div class="w-16 h-16 sm:mr-8 sm:mb-0 mb-4 rounded-full overflow-hidden flex-shrink-0 bg-indigo-100 flex items-center justify-center">
                              {% if lead.profile_image %}
                              <img src="{{ lead.profile_image.url }}" alt="{{ lead.first_name }} {{ lead.last_name }}" class="w-full h-full object-cover">
                              {% else %}
                              <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-8 h-8 text-indigo-500" viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
                              {% endif %}
                         </div>
                         <div class="flex-grow">
                              <h2 class="text-gray-900 text-lg title-font font-medium mb-3">{{ lead.first_name }} {{ lead.last_name }}</h2>
                              <div class="leading-relaxed text-base mb-3">
                                   <p class="mb-1"><strong>Email:</strong> {{ lead.email|default:"Not provided" }}</p>
                                   <p class="mb-1"><strong>Phone:</strong> {{ lead.phone_number|default:"Not provided" }}</p>
                                   <p class="mb-1"><strong>Source:</strong> <span class="text-blue-600 font-medium">{{ lead.source_category.name|default:"Unassigned" }}</span></p>
                                   <p class="mb-1"><strong>Value:</strong> <span class="text-green-600 font-medium">{{ lead.value_category.name|default:"Unassigned" }}</span></p>
                                   <p class="mb-1"><strong>Status:</strong> <span class="text-red-600 font-medium">Unassigned Agent</span></p>
                                   {% if request.user.is_superuser %}
                                   <p class="mb-1"><strong>Organisation:</strong> <span class="text-orange-600 font-medium">{{ lead.organisation.user.username }}</span></p>
                                   {% endif %}
                              </div>
                              <a href="{% url 'leads:lead-detail' lead.pk %}" class="view-lead-link mt-3 text-indigo-500 inline-flex items-center hover:text-blue-900">View this lead
                                   <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 ml-2" viewBox="0 0 24 24">
                                        <path d="M5 12h14M12 5l7 7-7 7"></path>
                                   </svg>
                              </a>
                              <span class="mx-2">|</span>
                              <a href="{% url 'leads:assign-agent' lead.pk %}" class="assign-agent-link mt-3 text-indigo-500 inline-flex items-center hover:text-blue-900">Assign Agent
                                   <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 ml-2" viewBox="0 0 24 24">
                                        <path d="M5 12h14M12 5l7 7-7 7"></path>
                                   </svg>
                              </a>
                         </div>
                    </div>
               </div>
               {% endfor %}
          </div>
          {% endif %}
     </div>
</section>

{% endblock content %}